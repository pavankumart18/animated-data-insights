<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Animated Data Insights â€” Treemap Dashboard</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap">
  <style>
    :root{--bg:#FAF7F2;--muted:#6b6b66;--card:#ffffff;--rule:#e9e6df}
    html,body{height:100%;margin:0;background:var(--bg);color:#222;font-family:Inter,system-ui,Arial}
    /* Fit entire dashboard to the viewport */
    .app{display:flex;gap:24px;padding:24px;box-sizing:border-box;height:100vh;height:100dvh}
    .panel{background:var(--card);border-radius:12px;box-shadow:0 6px 20px rgba(20,20,20,0.06);padding:18px}
    .left{width:420px;display:flex;flex-direction:column;height:calc(100vh - 48px);height:calc(100dvh - 48px);min-height:0}
    .right{flex:1;display:flex;flex-direction:column;height:calc(100vh - 48px);height:calc(100dvh - 48px);min-height:0;overflow:hidden}
    .controls{display:flex;align-items:center;gap:8px;margin-bottom:18px;flex-wrap:wrap}
    .controls h2{flex:0 1 auto;min-width:0}
    .control-end{margin-left:auto;display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:flex-end;min-width:0;max-width:100%}
    #mode-select{flex:0 0 auto}
    #place-select{flex:1 1 220px;min-width:160px;max-width:100%}
    @media (max-width: 540px){ .controls label[for="mode-select"]{display:none} #place-select{flex-basis:100%} }
    .nav-btn, select{background:#f7f5f0;border:1px solid #e3dfd6;border-radius:8px;padding:8px 12px;font-size:12px;color:#444;cursor:pointer}
    .nav-btn:hover{background:#efece6}
    #treemap-wrap{flex:1;min-height:0}
    svg{display:block;width:100%;height:100%}
    .tile{stroke:#ffffff00;stroke-width:1}
    .label{font-size:12px;font-weight:400;pointer-events:none;fill:#000}
    .label .pct{fill:#000;font-size:11px}
    h1,h2,h3{margin:0}
    .topics{display:flex;flex-direction:column;min-height:0}
    .topics h3{margin-top:0}
    .topics .small-muted{color:var(--muted);font-size:12px}
    .topics ul{list-style:none;padding:0;margin:0;overflow:auto;flex:1}
    .topic{padding:14px;border-bottom:1px solid var(--rule);display:flex;justify-content:space-between;align-items:center}
    .title{max-width:300px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .pct{color:#111;font-weight:600}
    @media (max-width: 980px){ .app{flex-direction:column} .left{width:auto;height:auto} .right{height:auto} }
  </style>
  <noscript>Enable JavaScript to view this dashboard.</noscript>
  <meta name="description" content="Interactive treemap of topics by state or country with animated transitions.">
  <meta name="color-scheme" content="light only">
  <link rel="icon" href="data:,">
  <meta name="referrer" content="no-referrer" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="noindex" />
  <style>
    /* Slight focus styles for a11y */
    .nav-btn:focus, select:focus { outline: 2px solid #60a5fa; outline-offset: 2px; }
  </style>
  
</head>
<body>
  <div class="app">
    <div class="panel left">
      <div class="controls">
        <h2 id="place-title">Location</h2>
        <div class="control-end" style="margin-left:auto;display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:flex-end;max-width:100%">
          <label for="mode-select" class="small-muted">Mode</label>
          <select id="mode-select" class="nav-btn">
            <option value="states">States</option>
            <option value="countries">Countries</option>
          </select>
          <select id="place-select" class="nav-btn" aria-label="Select state or country"></select>
        </div>
      </div>
      <div class="topics panel" style="margin-top:12px">
        <h3>Most frequent</h3>
        <div class="small-muted">The most common topics</div>
        <ul id="topic-list" style="margin-top:12px"></ul>
      </div>
    </div>
    <div class="panel right">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
        <h3 style="margin:0">How people are using Claude</h3>
        <div class="small-muted">Treemap fitted to viewport</div>
      </div>
      <div id="treemap-wrap"><svg id="treemap-svg" aria-label="Treemap visualization"></svg></div>
    </div>
  </div>

  <script>
    (function(){
      function load(url, done){ var s=document.createElement('script'); s.src=url; s.async=true; s.onload=done; s.onerror=done; document.head.appendChild(s); }
      function boot(){ var s=document.createElement('script'); s.src='script.js'; s.async=true; document.body.appendChild(s); }
      if (window.d3) { boot(); }
      else {
        load('https://d3js.org/d3.v7.min.js', function(){
          if (window.d3) return boot();
          load('https://cdn.jsdelivr.net/npm/d3@7', function(){
            if (window.d3) return boot();
            var box=document.createElement('div');
            box.style.margin='12px'; box.style.padding='10px 12px'; box.style.border='1px solid #e3dfd6'; box.style.borderRadius='8px'; box.style.background='#fff8e1'; box.style.color='#6b5e00'; box.style.fontSize='12px';
            box.innerText='Failed to load D3 from CDNs. Please check your network or run via a local server.';
            document.body.insertBefore(box, document.body.firstChild);
          });
        });
      }
    })();
  </script>
  
</body>
</html>
